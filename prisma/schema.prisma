// This File Contains

// USER MODEL => This Model contains User Releted Information

// CATEGORY MODEL => This Model contains Category Releted Information
// SUBCATEGORY MODEL => This Model contains SubCategory Releted Information
// PRODUCT MODEL => This Model contains Product Releted Information



generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// All Enums are here 
enum Role {
  USER
  ADMIN
  STORE_MANAGER
  SALES_MANAGER
  INVENTORY_MANAGER
  SUPPORT_MANAGER
  SUPPORT_REPRESENTATIVE
  SALES_REPRESENTATIVE

}

model User {
  id String @id @default(uuid())
  name String
  email String @unique
  password String
  role Role @default(USER)
  phone String
  secondaryPhone String?
  address String
  tokens RefreshToken[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt 
}

model RefreshToken {
  id String @id @default(uuid())
  token String
  userId String
  user User @relation(fields: [userId], references: [id])
  expiresAt DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt 
}

// Products Releted models . For here we add a model category, subcategory and product.
model Category {
  id String @id @default(uuid())
  name String @unique
  description String?
  subcategories SubCategory[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt 
}

model SubCategory {
  id String @id @default(uuid())
  name String @unique
  description String?
  categoryId String
  category Category @relation(fields: [categoryId], references: [id])
  products Product[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt 
}

model Product {
  id            String           @id @default(uuid())
  name          String
  description   String
  brand         String
  subCategoryId String
  subCategory   SubCategory      @relation(fields: [subCategoryId], references: [id])
  variants      ProductVariant[] // Product owns the variants
  skus          SKU[]            // For products with NO variants
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt 
}

model ProductVariant {
  id            String       @id @default(uuid())
  name         String
  productId     String
  product       Product      @relation(fields: [productId], references: [id])
  size          String?
  color         String?
  skus          SKU[]
  images        productImageAttribute[]
}

model SKU {
  id               String          @id @default(uuid())
  skuCode          String          @unique
  price            Float
  stock            Int
  productId        String
  product          Product         @relation(fields: [productId], references: [id])
  productVariantId String
  productVariant   ProductVariant @relation(fields: [productVariantId], references: [id])
}

model productImageAttribute {
  id String @id @default(uuid())
  imageBannar String
  imageGallery String[]
  productVariantId  String
  productVariant ProductVariant @relation(fields: [productVariantId], references: [id])

}
